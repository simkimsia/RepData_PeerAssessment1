# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
```{r}
source("load_data.R")

dataset <- load_data()
```

## What is mean total number of steps taken per day?
```{r}
source("mean_total_steps_every_day.R")

total_steps_per_day <- get_total_steps_per_day(dataset)

  ## draw the histogram
  library(ggplot2)
  ggplot(total_steps_per_day, aes(x=days, y=total_steps)) + 
    geom_bar(stat='identity', width=1, aes(fill="red"), colour="#CC0000") + 
    xlab("Days") +
    ylab("Total steps") +
    ggtitle("Total steps every day")

mean_total_steps <- mean(total_steps_per_day$total_steps)
median_total_steps <- median(total_steps_per_day$total_steps)
```
**Mean total number of steps taken per day is:** 
```{r} 
mean_total_steps 
```
**Median total number of steps taken per day is:** 
```{r} 
median_total_steps 
```

## What is the average daily activity pattern?
```{r}
source("time_series.R")

mean_steps_per_interval <- get_mean_steps_per_interval(dataset)

  # Create the time series plot
  library(ggplot2)
  ggplot(mean_steps_per_interval, aes(x=intervals, y=mean_steps)) + 
    geom_line(colour="#0000CC") +
    xlab("Intervals") +
    ylab("Mean steps") +
    ggtitle("Mean steps across all days for all 5-min intervals")

max_interval <- find_max_interval(mean_steps_per_interval)
```
**Interval with the max mean steps is:** 
```{r} 
max_interval[1, "intervals"]
```

**It has recorded the following mean steps :** 
```{r} 
max_interval[1, "max_mean"]
```

## Imputing missing values
```{r}
source("imputing_missing_values.R")

missing_values <- find_count_missing_values(dataset)

```
**Number of missing values :** 
```{r} 
missing_values[1, "missing"]
```

Now replacing NAs with the mean steps in all the 5-min intervals
```{r}

replaced_with_5min_mean_dataset <- replace_missing_values(dataset, mean_steps_per_interval)

```

Now creating the histogram for the new dataset with the values replaced
```{r}
new_total_steps_per_day <- get_total_steps_per_day(replaced_with_5min_mean_dataset)

  ## draw the histogram
  library(ggplot2)
  ggplot(new_total_steps_per_day, aes(x=days, y=total_steps)) + 
    geom_bar(stat='identity', width=1, aes(fill="green"), fill="#66FF66", colour="#00CC00") + 
    xlab("Days") +
    ylab("Total steps") +
    ggtitle("Total steps every day for dataset with NAs replaced")

new_mean_total_steps <- mean(new_total_steps_per_day$total_steps)
new_median_total_steps <- median(new_total_steps_per_day$total_steps)
```
**Mean total number of steps taken per day for dataset with NAs replaced is:** 
```{r} 
new_mean_total_steps 
```
**Median total number of steps taken per day for dataset with NAs replaced is:** 
```{r} 
new_median_total_steps 
```

## Are there differences in activity patterns between weekdays and weekends?
